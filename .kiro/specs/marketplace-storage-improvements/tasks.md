# Implementation Plan

- [x] 1. Обновить StorageTab - удалить перемещение в коллекцию и улучшить отображение


  - Удалить кнопку "В коллекцию" и связанную функцию handleMoveToCollection
  - Убедиться, что карточки отображаются индивидуально (уже реализовано)
  - Обновить UI для отображения только кнопок "Быстрая продажа" и "Выставить на продажу"
  - _Requirements: 1.1, 1.2, 1.3, 3.1, 3.2, 3.3_






- [ ] 2. Создать компонент CardDetailModal для детального просмотра карточек
  - Создать новый файл cybersport-cards/src/components/cards/CardDetailModal.js

  - Реализовать отображение статистики карточки (имя, рейтинг, команда, позиция)


  - Добавить кнопки "Быстрая продажа" и "Выставить на торговую площадку"
  - Добавить поддержку prop 'source' для различия между коллекцией и хранилищем



  - Создать CSS файл cybersport-cards/src/styles/CardDetailModal.css


  - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 8.1, 8.2, 8.3, 8.4_

- [ ] 3. Интегрировать CardDetailModal в StorageTab
  - Добавить состояние для выбранной карточки и отображения модального окна




  - Добавить обработчик клика по карточке для открытия модального окна
  - Передать source='storage' в CardDetailModal

  - Реализовать обработчики для быстрой продажи и выставления на ТП из модального окна
  - _Requirements: 8.1, 8.2, 8.3, 8.4_





- [ ] 4. Интегрировать CardDetailModal в ProfilePage (коллекция)
  - Добавить состояние для выбранной карточки и отображения модального окна в ProfilePage
  - Сделать карточки в коллекции кликабельными (isClickable={true})
  - Передать source='collection' в CardDetailModal



  - Реализовать обработчики для быстрой продажи и выставления на ТП из коллекции
  - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5, 7.6_


- [x] 5. Обновить CardChoiceModal для обработки дубликатов

  - Добавить проверку isDuplicate для каждой карточки

  - Условно отображать кнопки в зависимости от наличия карточки в коллекции
  - Для дубликатов: показывать только "В хранилище", "Быстрая продажа", "Выставить на ТП"
  - Для новых карточек: показывать все опции включая "В коллекцию"




  - Добавить визуальный индикатор дубликатов (например, значок или текст)

  - _Requirements: 2.1, 2.2, 2.3, 2.4_

- [ ] 6. Добавить функциональность выставления на ТП в CardChoiceModal
  - Добавить новую кнопку "Выставить на торговую площадку" в CardChoiceModal



  - Создать модальное окно для ввода цены
  - Реализовать обработчик для выставления карточек на ТП напрямую из пака
  - Обновить onProcessCards для поддержки action='marketplace'
  - _Requirements: 4.1, 4.2, 4.3, 4.4_

- [ ] 7. Обновить backend API для выставления карточек из коллекции
  - Обновить POST /api/marketplace в marketplaceRoutes.js

  - Добавить проверку наличия карточки в коллекции (не только в хранилище)
  - Обновить логику удаления карточки из коллекции при выставлении на ТП
  - Добавить валидацию для предотвращения выставления несуществующих карточек
  - _Requirements: 4.1, 4.2, 4.3, 4.4_



- [ ] 8. Обновить backend API для обработки покупки дубликатов
  - Обновить POST /api/marketplace/:id/buy в marketplaceRoutes.js
  - Добавить проверку наличия карточки в коллекции покупателя
  - Если карточка уже в коллекции - добавлять в хранилище

  - Если карточка новая - добавлять в коллекцию
  - Добавить проверку переполнения хранилища (максимум 100)
  - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5, 5.6_

- [ ] 9. Обновить backend API для отмены объявлений
  - Проверить DELETE /api/marketplace/:id в marketplaceRoutes.js


  - Убедиться, что карточка возвращается в хранилище (не в коллекцию)
  - Добавить проверку переполнения хранилища при отмене
  - _Requirements: 6.1, 6.2, 6.3, 6.4_

- [ ] 10. Обновить profileRoutes для предотвращения добавления дубликатов в коллекцию
  - Обновить POST /api/profile/process-cards в profileRoutes.js
  - Добавить проверку при action='collection' на наличие карточки в коллекции
  - Возвращать ошибку если пытаются добавить дубликат в коллекцию
  - _Requirements: 2.1, 2.2, 2.3, 2.4_

- [x] 11. Создать отдельную страницу MarketplacePage
  - Создать новый файл cybersport-cards/src/pages/MarketplacePage.js
  - Перенести функциональность из MarketplaceTab.js в новую страницу
  - Реализовать загрузку объявлений, покупку и отмену
  - Добавить фильтрацию по сезону, редкости, команде
  - Добавить поиск по имени игрока
  - Добавить сортировку по цене
  - _Requirements: 9.1, 9.2, 9.3, 9.4, 9.5_

- [x] 12. Обновить навигацию для добавления ссылки на торговую площадку
  - Обновить App.js для добавления маршрута /marketplace
  - Обновить Header/Navigation компонент для добавления ссылки "Торговая площадка"
  - Разместить ссылку после "Магазин" и перед "Профиль"
  - _Requirements: 9.1, 9.2_

- [x] 13. Создать CSS стили для новых компонентов и обновлений
  - Создать cybersport-cards/src/styles/CardDetailModal.css
  - Создать cybersport-cards/src/styles/MarketplacePage.css
  - Обновить cybersport-cards/src/styles/StorageTab.css (убрать стили для кнопки "В коллекцию")
  - Обновить cybersport-cards/src/styles/ShopPage.css для индикаторов дубликатов
  - Добавить стили для модального окна ввода цены в CardChoiceModal
  - _Requirements: 1.1, 1.2, 1.3, 7.1, 7.2, 8.1, 8.2, 9.3_

- [x] 14. Тестирование и финальная интеграция
  - Протестировать открытие пака с дубликатами
  - Протестировать выставление карточек на ТП из хранилища
  - Протестировать выставление карточек на ТП из коллекции
  - Протестировать покупку новых карточек (должны попадать в коллекцию)
  - Протестировать покупку дубликатов (должны попадать в хранилище)
  - Протестировать отмену объявлений
  - Протестировать клик по карточкам в коллекции и хранилище
  - Протестировать навигацию на страницу торговой площадки
  - Протестировать фильтрацию и поиск на торговой площадке
  - Проверить все граничные случаи (переполнение хранилища, недостаточно коинов)
  - _Requirements: All_
